<!-- 
/*
 *	This content is generated from the PSD File Info.
 *	(Alt+Shift+Ctrl+I).
 *
 *	@desc 		
 *	@file 		skills_tree
 *	@date 		Tuesday 21st of March 2023 10:39:32 PM
 *	@title 		Page 1
 *	@author 	
 *	@keywords 	
 *	@generator 	Export Kit v1.3.figma
 *
*/
 -->
 <!DOCTYPE html>
 <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" >
	 <head>
		 <meta http-equiv="content-type" content="text/html" charset="utf-8" />
		 <title>Math Castle</title>
		 <meta name="viewport" content="width=device-width, initial-scale=1.0">
		 <meta name="description" content="" >
		 <link rel="StyleSheet" href="./styles/skills_tree.css" />
		 <script src="https://secure.exportkit.com/cdn/js/ek_googlefonts.js?v=6"></script>
		 <!-- Add your custom HEAD content here -->
 
	 </head>
	 <body>
		 <div id="content-container" >
			 <div id="_bg__skills_tree"  ></div>
			 <img src="images/cloud4.png" id="cloud" />
			 <img src="images/cloud_ek14.png" id="cloud_ek1" />
			 <img src="images/cloud_ek24.png" id="cloud_ek2" />
			 <img src="images/cloud_ek34.png" id="cloud_ek3" />
			 <div id="rectangle_15"  ></div>
			 <div id="_2_skill_point" >
				 2 Skill Point
			 </div>
			 <div id="_3_skill_point" >
				 3 Skill Point
			 </div>
			 <div id="_4_skill_point" >
				 4 Skill Point
			 </div>
			 <div id="header"  ></div>
			 <div id="sp11" tabindex="0" ></div>
 
			 <div id="sp12" tabindex="0" ></div>
			 <div id="sp13" tabindex="0" ></div>
			 <div id="sp22" tabindex="0" ></div>
			 <div id="sp23" tabindex="0" ></div>
			 <div id="sp31" tabindex="0" ></div>
			 <div id="sp32" tabindex="0" ></div>
			 <div id="sp42" tabindex="0" ></div>
		 
			 <img src="images/arrow_2.png" id="arrow_2" />
			 <img src="images/arrow_1.png" id="arrow_1" />
			 <img src="images/arrow_3.png" id="arrow_3" />
			 <img src="images/arrow_4.png" id="arrow_4" />
			 <img src="images/arrow_5.png" id="arrow_5" />
			 <img src="images/arrow_6.png" id="arrow_6" />
			 <img src="images/arrow_7.png" id="arrow_7" />
			 
			 
			 
			 <a id="backlink" href="./main_menu.html">		
				 <div id="backbtn" ></div>
				 <div id="back" >Back</div>
			 </a>
	 
 
			 <div id="buybtn" >Buy</div>
 
	 
			 <script>
				let settings = {
					SPAWN_POINTS: {
						FIRST_LANE: { x: -900, y: -165 },
						SECOND_LANE: { x: -900, y: -20 },
						THIRD_LANE: { x: -900, y: 125 },
					},
					POINTS: {
						CORRECT_ANSWER: 10,
						WRONG_ANSWER: -2,
						CASTLE_LIFE_LOST: -10,
					},
					enemySpeed: 60,
					enemySpeedIncrement: 1,
					spawnTimerMs: 3500,
					gameTimerMs: 300000,
					questionDifficulty: 'Medium',
					castleStartingLives: 3,
					lastAnswersToShow: 5,
				};

				localStorage.setItem("Settings", JSON.stringify(settings));

				const currentUser = JSON.parse(localStorage.getItem("user")) || "john_doe";
				function updateUserSkills(user, newSkill) {
					let users = JSON.parse(localStorage.getItem("users"));


					
					if (users) {
						for (let i = 0; i < users.length; i++) {
							console.log(users[i].user_name);
							if (users[i].user_name === user.user_name) {
								if (!users[i].skills) {
								users[i].skills = [];
								}
								users[i].skills.push(newSkill);
								localStorage.setItem("users", JSON.stringify(users));
								break;
							}
						}
					}
					console.log(users);
				}
				
				 //import {change11} from './skills_tree';
				 const btns = [document.getElementById("sp11"), document.getElementById("sp12"), document.getElementById("sp13"), document.getElementById("sp22"), 
							 document.getElementById("sp23"), document.getElementById("sp31"), document.getElementById("sp32"), document.getElementById("sp42")]
			 
 
				 const button2 = document.getElementById("buybtn");
 
				 const btnsClicked = [false,false,false,false,false,false,false,false];
				 let button2Clicked = false;
 
				 function setAllFalse(exclude = -1){
					 for(let i = 0; i < btnsClicked.length; i++){
						 if(exclude != -1){
							 if(i == exclude){
								 continue;
							 }
						 }
						 btnsClicked[i] = false;
					 }
				 }
				 let oneClicked = false;
				 let index = -1;
				 function checkButtons() {
			 
					 for(let i = 0; i < btns.length; i++){
						 if(btnsClicked[i] == true){
							 oneClicked = true;
							 index = i;
							 break;
						 }
					 }
			 
					 if(!oneClicked && button2Clicked == true){
						alert("Please select a skill to purchase!");
						button2Clicked = false;
					 }
					 if (oneClicked && button2Clicked) {
						 if(index == 0){
							settings.gameTimerMs = 400000;
							alert("Increased game time!");
							localStorage.setItem("Settings", JSON.stringify(settings));
							updateUserSkills(currentUser, "IncreasedGameTime 1");
		
						 }
						 else if(index == 1){
							settings.enemySpeed = 55;
							alert("Decreased enemy speed to 55!");
							localStorage.setItem("Settings", JSON.stringify(settings));
							updateUserSkills(currentUser, "slowerEnemy 1");
						 }
						 else if(index == 2){
							settings.castleStartingLives = 4;
							alert("You now how 4 starting lives!");
							localStorage.setItem("Settings", JSON.stringify(settings));
							updateUserSkills(currentUser, "moreLives 1");
						 }
						 else if(index == 3){
							settings.enemySpeed = 50;
							alert("Decreased enemy speed to 50!");
							localStorage.setItem("Settings", JSON.stringify(settings));
							updateUserSkills(currentUser, "slowerEnemy 2");
						 }
						 else if(index == 4){
							settings.castleStartingLives = 5;
							alert("You now have 5 starting lives");
							localStorage.setItem("Settings", JSON.stringify(settings));
							updateUserSkills(currentUser, "moreLives 2");
						 }
						 else if(index == 5){
							settings.gameTimerMs = 500000;
							alert("Increased game time!");
							localStorage.setItem("Settings", JSON.stringify(settings));
							updateUserSkills(currentUser, "IncreasedGameTime 2");
						 }
						 else if(index == 6){
							settings.enemySpeed = 45;
							alert("Decreased enemy speed to 45!");
							localStorage.setItem("Settings", JSON.stringify(settings));
							updateUserSkills(currentUser, "slowerEnemy 3");
						 }
						 else if(index == 7){
							settings.enemySpeed = 40;
							alert("Decreased enemy speed to 40!");
							localStorage.setItem("Settings", JSON.stringify(settings));
							updateUserSkills(currentUser, "slowerEnemy 4");
						 }
						 // Both buttons have been clicked, execute your function here
						 console.log("Both buttons clicked!");
						 oneClicked = false;
						 setAllFalse();
						 index = -1;
						 button2Clicked = false;
 
					 }
				 
				 }
				 
				 btns[0].addEventListener("click", function() {
					 btnsClicked[0] = true;
					 setAllFalse(0);
					 checkButtons();
				 });
				 btns[1].addEventListener("click", function() {
					 btnsClicked[1] = true;
					 setAllFalse(1);
					 checkButtons();
				 });
				 btns[2].addEventListener("click", function() {
					 btnsClicked[2] = true;
					 setAllFalse(2);
					 checkButtons();
				 });
				 btns[3].addEventListener("click", function() {
					 btnsClicked[3] = true;
					 setAllFalse(3);
					 checkButtons();
				 });
				 btns[4].addEventListener("click", function() {
					 btnsClicked[4] = true;
					 setAllFalse(4);
					 checkButtons();
				 });
				 btns[5].addEventListener("click", function() {
					 btnsClicked[5] = true;
					 setAllFalse(5);
					 checkButtons();
				 });
				 btns[6].addEventListener("click", function() {
					 btnsClicked[6] = true;
					 setAllFalse(6);
					 checkButtons();
				 });
				 btns[7].addEventListener("click", function() {
					 btnsClicked[7] = true;
					 setAllFalse(7);
					 checkButtons();
				 });
				 button2.addEventListener("click", function() {
					 button2Clicked = true;
					 checkButtons();
 
				 });
			 </script>
 
			 <div id="skill_tree" >
				 Skill  Tree - points: &infin;
			 </div>
			 <div id="_1_skill_point" >
				 1 Skill Point
			 </div>
 
		 </div>
	 </body>
 </html>